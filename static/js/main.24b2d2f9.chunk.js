(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(e,t,a){},21:function(e,t,a){e.exports=a(30)},30:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(17),o=a.n(s),c=(a(16),a(1)),i=a(2),l=a(5),u=a(3),h=a(6),p=a(4),g=a(8),m=a(10),d=a(19),b=a(20),E=a.n(b);var f={shows:[],isLoading:!0,currentPage:1,tableCaption:"",isLastPage:!1,error:!1,search:null},y=Object(m.c)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_API_DATA_START":return Object(g.a)({},e,{isLoading:!0});case"GET_API_DATA_READY":return Object(g.a)({},e,{shows:t.data.shows,countryList:t.data.countryList,tableCaption:t.data.tableCaption,isLastPage:t.data.isLastPage,lastPageNumber:t.data.lastPageNumber,isLoading:!1});case"GET_API_DATA_ERROR":return Object(g.a)({},e,{error:t.error,isLoading:!1});case"SEARCH_QUERY_SUBMIT":return Object(g.a)({},e,{currentPage:1,search:t.search});case"NEXT_PAGE":return Object(g.a)({},e,{currentPage:e.currentPage+1});case"PREVIOUS_PAGE":return Object(g.a)({},e,{currentPage:e.currentPage-1});default:return e}},Object(m.a)(d.a,E.a)),P={baseUrl:"https://api.trakt.tv/",headers:{"Content-type":"application/json","trakt-api-key":"38760291a0e06beeee9e5a43a2217cea8108ee0dc6d9a2fbcf784ac9aec2bdc3","trakt-api-version":2}};function v(e){return function(t){t({type:"GET_API_DATA_START"}),function(e){var t,a=e.currentPage,r=e.search,n="",s=!1;n=r?P.baseUrl+"search/show?page="+a+"&years="+r.years+"&fields=title&query="+r.queryString+"&countries="+r.country+"&limit=10":P.baseUrl+"shows/trending?page="+a;return fetch(n,{headers:P.headers}).then(function(e){if(200===e.status){var a=t=e.headers.get("X-Pagination-Page-Count"),r=e.headers.get("X-Pagination-Page");return s=a===r,e.json()}console.log("Looks like there was a problem. Status Code: "+e.status)}).then(function(e){return console.log(s),{shows:e,isLastPage:s,lastPageNumber:t}}).catch(function(e){return e})}(e).then(function(a){Promise.all(a.shows.map(function(e){return function(e){var t="https://api.themoviedb.org/3/find/"+e.show.ids.imdb+"?api_key=bcdbbabd42939d9fe3b0800ec18a70cf&external_source=imdb_id";return fetch(t).then(function(e){if(200===e.status)return e.json();console.log("Looks like there was a problem. Status Code: "+e.status)}).then(function(t){if(0!==t.tv_results.length&&t.tv_results[0].poster_path){var a="https://image.tmdb.org/t/p/w200"+t.tv_results[0].poster_path;return{title:e.show.title,poster:a,year:e.show.year,country:t.tv_results[0].origin_country}}return{title:e.show.title,poster:"",year:e.show.year,country:""}}).catch(function(e){console.log("Fetch Error : -S",e)})}(e)})).then(function(r){fetch(P.baseUrl+"countries/shows",{headers:P.headers}).then(function(e){return e.json()}).then(function(n){var s;console.log(a.isLastPage),s={shows:r,countryList:n,tableCaption:e.search?"Search":"Trending",isLastPage:a.isLastPage,lastPageNumber:a.lastPageNumber},t({type:"GET_API_DATA_READY",data:{shows:s.shows,countryList:s.countryList,tableCaption:s.tableCaption,isLastPage:s.isLastPage,lastPageNumber:s.lastPageNumber}})})})}).catch(function(e){return function(e){return t({type:"GET_API_DATA_ERROR",error:e})}(e)})}}var w=function(){return n.a.createElement("h1",null,"Look up your favorite TV shows!")},O=function(e){function t(){var e,a;Object(c.a)(this,t);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).submitHandler=function(e){e.preventDefault();var t={queryString:a.refs.searchString.value,years:a.refs.searchYear.value,country:a.refs.searchCountry.value};a.props.dispatch({type:"SEARCH_QUERY_SUBMIT",search:t}),a.props.dispatch(v(y.getState()))},a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){if(this.props.isLoading||this.props.error)return null;var e=this.props.countryList.map(function(e,t){return n.a.createElement("option",{key:t,value:e.code},e.name)});return n.a.createElement("div",{id:"userInput"},n.a.createElement("form",{onSubmit:this.submitHandler},n.a.createElement("label",{htmlFor:"searchString"},"Title: "),n.a.createElement("input",{type:"text",ref:"searchString",name:"searchString",placeholder:"Search shows..."}),n.a.createElement("label",{htmlFor:"searchYear"},"Year: "),n.a.createElement("input",{type:"number",min:"1900",max:(new Date).getFullYear(),ref:"searchYear",name:"searchYear"}),n.a.createElement("label",{htmlFor:"searchCountry"},"Country: "),n.a.createElement("select",{ref:"searchCountry",name:"searchCountry"},n.a.createElement("option",{defaultValue:!0}),e),n.a.createElement("button",{type:"submit"},"Search...")))}}]),t}(r.Component);var L=Object(p.b)(function(e){return{countryList:e.countryList,isLoading:e.isLoading,error:e.error}})(O),j=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){if(this.props.isLoading)return n.a.createElement("div",{id:"loadingSVG"},n.a.createElement("img",{src:"91.svg",alt:"...LOADING"}),n.a.createElement("h2",null,"loading..."));if(this.props.error)return n.a.createElement("div",null,n.a.createElement("h1",null,"SOMETHING BAD HAPPENED!"));if(0===this.props.shows.length)return n.a.createElement("h1",null,"NOTHING FOUND!");var e=this.props.shows.map(function(e,t){return n.a.createElement("tr",{key:t},n.a.createElement("th",{width:"5%"},t+1),n.a.createElement("td",{width:"100px"},n.a.createElement("img",{src:e.poster,alt:'"'+e.title+'" poster.',width:"100px"})),n.a.createElement("td",null,e.title),n.a.createElement("td",{width:"10%"},e.year),n.a.createElement("td",{width:"10%"},e.country?e.country.join(", "):"n/a"))});return n.a.createElement("table",null,n.a.createElement("caption",null,this.props.tableCaption),n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",null,"Number"),n.a.createElement("th",null,"Poster"),n.a.createElement("th",null,"Title"),n.a.createElement("th",null,"Year"),n.a.createElement("th",null,"Country"))),n.a.createElement("tbody",null,e))}}]),t}(r.Component);var _=Object(p.b)(function(e){return{shows:e.shows,isLoading:e.isLoading,tableCaption:e.tableCaption,error:e.error}})(j),A=function(e){function t(){var e,a;Object(c.a)(this,t);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).nextPage=function(){a.props.isLastPage||(a.props.dispatch({type:"NEXT_PAGE"}),a.props.dispatch(v(y.getState())))},a.previousPage=function(){1!==a.props.currentPage&&(a.props.dispatch({type:"PREVIOUS_PAGE"}),a.props.dispatch(v(y.getState())))},a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return 0===this.props.shows.length||this.props.isLoading?null:n.a.createElement("div",{id:"pagination"},n.a.createElement("div",{id:"prev"},n.a.createElement("button",{onClick:this.previousPage},"PREV")),n.a.createElement("div",null,n.a.createElement("p",null,"page ",this.props.currentPage," of ",this.props.lastPageNumber)),n.a.createElement("div",{id:"next"},n.a.createElement("button",{onClick:this.nextPage},"NEXT")))}}]),t}(r.Component);var C=Object(p.b)(function(e){return{shows:e.shows,currentPage:e.currentPage,isLastPage:e.isLastPage,lastPageNumber:e.lastPageNumber,isLoading:e.isLoading}})(A),S=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentWillMount",value:function(){y.dispatch(v(y.getState()))}},{key:"render",value:function(){return n.a.createElement(p.a,{store:y},n.a.createElement(w,null),n.a.createElement(L,null),n.a.createElement(_,null),n.a.createElement(C,null))}}]),t}(r.Component);o.a.render(n.a.createElement(S,null),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.24b2d2f9.chunk.js.map