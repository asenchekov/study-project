(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(e,t,a){},20:function(e,t,a){e.exports=a(29)},29:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(17),o=a.n(s),c=(a(16),a(2)),i=a(3),u=a(6),l=a(4),h=a(7),p=a(5),d=a(9),m=a(19),g=a(1),b="NEXT_PAGE",f="PREVIOUS_PAGE",E="GET_API_DATA_START",y="GET_API_DATA_READY",P="GET_API_DATA_ERROR",w="SEARCH_QUERY_SUBMIT",v={shows:[],isLoading:!0,currentPage:1,tableCaption:"",isLastPage:!1,error:!1,search:null};var O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E:return Object(g.a)({},e,{isLoading:!0});case y:return Object(g.a)({},e,{shows:t.data.shows,countryList:t.data.countryList,tableCaption:t.data.tableCaption,isLastPage:t.data.isLastPage,lastPageNumber:t.data.lastPageNumber,isLoading:!1});case P:return Object(g.a)({},e,{error:t.error,isLoading:!1});case w:return Object(g.a)({},e,{currentPage:1,search:t.search});case b:return Object(g.a)({},e,{currentPage:e.currentPage+1});case f:return Object(g.a)({},e,{currentPage:e.currentPage-1});default:return e}},L=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||d.c,j=Object(d.d)(O,L(Object(d.a)(m.a)));var C=function(){return n.a.createElement("h1",null,"Look up your favorite TV shows!")},_={baseUrl:"https://api.trakt.tv/",headers:{"Content-type":"application/json","trakt-api-key":"38760291a0e06beeee9e5a43a2217cea8108ee0dc6d9a2fbcf784ac9aec2bdc3","trakt-api-version":2}};function S(e){return function(t){t({type:E}),function(e){var t,a=e.currentPage,r=e.search,n="",s=!1;n=r?_.baseUrl+"search/show?extended=full&page="+a+"&years="+r.years+"&fields=title&query="+r.queryString+"&countries="+r.country+"&limit=10":_.baseUrl+"shows/trending?extended=full&page="+a;return fetch(n,{headers:_.headers}).then(function(e){if(200===e.status){var a=t=e.headers.get("X-Pagination-Page-Count"),r=e.headers.get("X-Pagination-Page");return s=a===r,e.json()}console.log("Looks like there was a problem. Status Code: "+e.status)}).then(function(e){return{shows:e,isLastPage:s,lastPageNumber:t}}).catch(function(e){return e})}(e).then(function(a){Promise.all(a.shows.map(function(e){return function(e){var t="https://api.themoviedb.org/3/find/"+e.show.ids.imdb+"?api_key=bcdbbabd42939d9fe3b0800ec18a70cf&external_source=imdb_id";return fetch(t).then(function(e){if(200===e.status)return e.json();console.log("Looks like there was a problem. Status Code: "+e.status)}).then(function(t){if(0!==t.tv_results.length&&t.tv_results[0].poster_path){var a="https://image.tmdb.org/t/p/w200"+t.tv_results[0].poster_path;return{title:e.show.title,poster:a,year:e.show.year,country:e.show.country}}return{title:e.show.title,poster:"",year:e.show.year,country:""}}).catch(function(e){console.log("Fetch Error : -S",e)})}(e)})).then(function(r){fetch(_.baseUrl+"countries/shows",{headers:_.headers}).then(function(e){return e.json()}).then(function(n){var s,o=e.search&&e.search.queryString?"Search '"+e.search.queryString+"'":"Trending";t((s={shows:r,countryList:n,tableCaption:o,isLastPage:a.isLastPage,lastPageNumber:a.lastPageNumber},{type:y,data:{shows:s.shows,countryList:s.countryList,tableCaption:s.tableCaption,isLastPage:s.isLastPage,lastPageNumber:s.lastPageNumber}}))})})}).catch(function(e){return t(function(e){return{type:P,error:e}}(e))})}}var k=function(e){function t(){var e,a;Object(c.a)(this,t);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(n)))).submitHandler=function(e){e.preventDefault();var t={queryString:a.refs.searchString.value,years:a.refs.searchYear.value,country:a.refs.searchCountry.value};a.props.dispatch({type:w,search:t}),a.props.dispatch(S(j.getState()))},a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){if(this.props.isLoading||this.props.error)return null;var e=this.props.countryList.map(function(e,t){return n.a.createElement("option",{key:t,value:e.code},e.name)});return n.a.createElement("div",{id:"userInput"},n.a.createElement("form",{onSubmit:this.submitHandler},n.a.createElement("label",{htmlFor:"searchString"},"Title: ",n.a.createElement("input",{type:"text",ref:"searchString",name:"searchString",placeholder:"Search shows..."})),n.a.createElement("label",{htmlFor:"searchYear"},"Year: ",n.a.createElement("input",{type:"number",min:"1950",max:(new Date).getFullYear(),ref:"searchYear",name:"searchYear"})),n.a.createElement("label",{htmlFor:"searchCountry"},"Country: ",n.a.createElement("select",{ref:"searchCountry",name:"searchCountry"},n.a.createElement("option",{defaultValue:!0}),e)),n.a.createElement("button",{type:"submit"},"Search...")))}}]),t}(r.Component);var N=Object(p.b)(function(e){return{countryList:e.countryList,isLoading:e.isLoading,error:e.error}})(k),A=function(e){return n.a.createElement("tr",null,n.a.createElement("th",{width:"5%"},e.index),n.a.createElement("td",{width:"100px"},n.a.createElement("img",{src:e.show.poster,alt:'"'+e.show.title+'" poster.',width:"100px"})),n.a.createElement("td",null,e.show.title),n.a.createElement("td",{width:"10%"},e.show.year),n.a.createElement("td",{width:"10%"},e.show.country?e.show.country.toUpperCase():"n/a"))},T=function(e){return n.a.createElement("div",{id:"loadingSVG"},n.a.createElement("img",{src:"91.svg",alt:"...LOADING"}),n.a.createElement("h2",null,"loading..."))},x=function(e){return n.a.createElement("div",null,n.a.createElement("h1",null,e.message))},D=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.dispatch(S(Object(g.a)({currentPage:this.props.currentPage},this.props.search)))}},{key:"render",value:function(){if(this.props.isLoading)return n.a.createElement(T,null);if(this.props.error)return n.a.createElement(x,{message:"SOMETHING BAD HAPPENED!"});if(0===this.props.shows.length)return n.a.createElement(x,{message:"NOTHING FOUND!"});var e=this.props.shows.map(function(e,t){return n.a.createElement(A,{key:t,index:t+1,show:e})});return n.a.createElement("table",null,n.a.createElement("caption",null,this.props.tableCaption),n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",null,"Number"),n.a.createElement("th",null,"Poster"),n.a.createElement("th",null,"Title"),n.a.createElement("th",null,"Year"),n.a.createElement("th",null,"Country"))),n.a.createElement("tbody",null,e))}}]),t}(r.Component);var I=Object(p.b)(function(e){return{shows:e.shows,search:e.search,currentPage:e.currentPage,isLoading:e.isLoading,tableCaption:e.tableCaption,error:e.error}})(D),R=function(e){function t(){var e,a;Object(c.a)(this,t);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(n)))).nextPage=function(){a.props.isLastPage||(a.props.dispatch({type:b}),a.props.dispatch(S(j.getState())))},a.previousPage=function(){1!==a.props.currentPage&&(a.props.dispatch({type:f}),a.props.dispatch(S(j.getState())))},a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return 0===this.props.shows.length||this.props.isLoading?null:n.a.createElement("div",{id:"pagination"},n.a.createElement("div",{id:"prev"},n.a.createElement("button",{onClick:this.previousPage},"PREV")),n.a.createElement("div",null,n.a.createElement("p",null,"page ",this.props.currentPage," of ",this.props.lastPageNumber)),n.a.createElement("div",{id:"next"},n.a.createElement("button",{onClick:this.nextPage},"NEXT")))}}]),t}(r.Component);var U=Object(p.b)(function(e){return{shows:e.shows,currentPage:e.currentPage,isLastPage:e.isLastPage,lastPageNumber:e.lastPageNumber,isLoading:e.isLoading}})(R),G=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return n.a.createElement(p.a,{store:j},n.a.createElement(C,null),n.a.createElement(N,null),n.a.createElement(I,null),n.a.createElement(U,null))}}]),t}(r.Component);o.a.render(n.a.createElement(G,null),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.d75d1c3f.chunk.js.map